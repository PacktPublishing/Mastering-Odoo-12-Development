<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <menuitem id="menu_school_root" name="School"
    sequence="25"
    groups="school.group_user"/>
    
  <!-- students -->
  <record model="ir.ui.view" id="student_view_list">
    <field name="name">student.list</field>
    <field name="model">res.partner</field>
    <field name="arch" type="xml">
      <tree string="Students">
        <field name="name"/>
        <field name="school_group_id"/>
        <field name="birthdate"/>
      </tree>
    </field>
  </record>

  <record model="ir.ui.view" id="student_view_form">
    <field name="name">student.form</field>
    <field name="model">res.partner</field>
    <field name="arch" type="xml">
      <form string="Student">
        <sheet>
          <field name="image" widget="image" class="oe_avatar" options="{&quot;preview_image&quot;: &quot;image_medium&quot;}"/>
          <div class="oe_title">
            <h1>
              <field name="name" default_focus="1" placeholder="Name"/>
            </h1>
            <field name="school_group_id" placeholder="Group"/>
          </div>
          <group>
            <field name="birthdate"/>
            <field name="inscription_date"/>
            <field name="member_for"/>
            <field name="student" groups="base.group_no_one" />
            <field name="student_type" />
            <field name="supervisor_id"/>
          </group>
          <group>
            <field name="option_ids" widget="many2many_tags"/>
          </group>
        </sheet>
      </form>
    </field>
  </record>

  <record model="ir.ui.view" id="student_view_graph">
    <field name="name">student.graph</field>
    <field name="model">res.partner</field>
    <field name="arch" type="xml">
      <graph string="Students">
        <field name="inscription_date" type="row" interval="quarter"/>
      </graph>
    </field>
  </record>

  <record model="ir.ui.view" id="student_view_search">
    <field name="name">student.search</field>
    <field name="model">res.partner</field>
    <field name="arch" type="xml">
      <search string="Students">
        <field name="name"/>
        <field name="school_group_id"/>
        <field name="supervisor_id"/>
      </search>
    </field>
  </record>

  <record model="ir.ui.view" id="student_view_kanban">
    <field name="name">student.kanban</field>
    <field name="model">res.partner</field>
    <field name="priority">100</field>
    <field name="arch" type="xml">
      <kanban class="o_kanban_mobile">
        <field name="id"/>
        <field name="name"/>
        <field name="school_group_id"/>
        <field name="supervisor_id"/>
        <templates>
          <t t-name="kanban-box">
            <div class="oe_kanban_global_click o_kanban_record">
              <div class="oe_kanban_details">
                <div class="o_kanban_record_top">
                  <div class="o_kanban_record_headings">
                    <strong class="o_kanban_record_title">
                      <div>
                        <strong><span t-esc="record.name.value"/></strong>
                      </div>
                    </strong>
                    <span class="o_kanban_record_subtitle"><span t-esc="record.school_group_id.value"/></span>
                  </div>
                </div>
                <div class="o_kanban_record_bottom">
                  <ul>
                    <li t-esc="record.supervisor_id.value" class="text-muted"/>
                  </ul>
                </div>
              </div>
            </div>
          </t>
        </templates>
        <searchpanel>
          <field name="student_type" string="Student Type"/>
          <field name="school_group_id" select="multi" string="Group" icon="fa-users" domain="[('student_count', '>', 0)]"/>
          <field name="option_ids" select="multi" string="Options"/>
        </searchpanel>
      </kanban>
    </field>
  </record>

  <record id="student_action" model="ir.actions.act_window">
    <field name="name">Students</field>
    <field name="res_model">res.partner</field>
    <field name="view_type">form</field>
    <field name="view_mode">tree,form,kanban,graph</field>
    <field name="view_ids" eval="[(5, 0, 0),
            (0, 0, {'view_mode': 'tree', 'view_id': ref('student_view_list')}),
            (0, 0, {'view_mode': 'kanban', 'view_id': ref('student_view_kanban')}),
            (0, 0, {'view_mode': 'graph', 'view_id': ref('student_view_graph')}),
            (0, 0, {'view_mode': 'form', 'view_id': ref('student_view_form')})]"/>
    <field name="search_view_id" ref="student_view_search"/>
    <field name="domain">[('student', '=', True)]</field>
    <field name="context">{'default_student': True}</field>
  </record>

  <menuitem id="school_student_menu" action="student_action"
    sequence="10" parent="school.menu_school_root"/>

  <!-- teachers -->
  <record model="ir.ui.view" id="teacher_view_list">
    <field name="name">teacher.list</field>
    <field name="model">res.partner</field>
    <field name="arch" type="xml">
      <tree string="Teachers">
        <field name="name"/>
        <field name="birthdate"/>
      </tree>
    </field>
  </record>

  <record model="ir.ui.view" id="teacher_view_form">
    <field name="name">teacher.form</field>
    <field name="model">res.partner</field>
    <field name="arch" type="xml">
      <form string="Teacher">
        <sheet>
          <field name="image" widget="image" class="oe_avatar" options="{&quot;preview_image&quot;: &quot;image_medium&quot;}"/>
          <div class="oe_title">
            <h1>
              <field name="name" default_focus="1" placeholder="Name"/>
            </h1>
          </div>
          <group>
            <field name="birthdate"/>
            <field name="teacher" groups="base.group_no_one" />
          </group>
        </sheet>
      </form>
    </field>
  </record>

  <record model="ir.ui.view" id="teacher_view_search">
    <field name="name">teacher.search</field>
    <field name="model">res.partner</field>
    <field name="arch" type="xml">
      <search string="Teachers">
        <field name="name"/>
      </search>
    </field>
  </record>

  <record id="teacher_action" model="ir.actions.act_window">
    <field name="name">Teachers</field>
    <field name="res_model">res.partner</field>
    <field name="view_type">form</field>
    <field name="view_mode">tree,form</field>
    <field name="view_ids" eval="[(5, 0, 0),
            (0, 0, {'view_mode': 'tree', 'view_id': ref('teacher_view_list')}),
            (0, 0, {'view_mode': 'form', 'view_id': ref('teacher_view_form')})]"/>
    <field name="search_view_id" ref="teacher_view_search"/>
    <field name="domain">[('teacher', '=', True)]</field>
    <field name="context">{'default_teacher': True}</field>
  </record>

  <menuitem id="school_teacher_menu" action="teacher_action"
    sequence="15" parent="school.menu_school_root"/>

  <!-- groups -->
  <record model="ir.ui.view" id="group_view_list">
    <field name="name">group.list</field>
    <field name="model">school.group</field>
    <field name="arch" type="xml">
      <tree string="Groups">
        <field name="name"/>
        <field name="supervisor_id"/>
        <field name="student_count"/>
      </tree>
    </field>
  </record>

  <record model="ir.ui.view" id="group_view_form">
    <field name="name">group.form</field>
    <field name="model">school.group</field>
    <field name="arch" type="xml">
      <form string="Group">
        <sheet>
          <div class="oe_title">
            <h1>
              <field name="name" default_focus="1" placeholder="Name"/>
            </h1>
          </div>
          <group>
            <field name="supervisor_id"/>
            <field name="student_ids"/>
          </group>
        </sheet>
        <div class="oe_chatter">
          <field name="message_follower_ids" widget="mail_followers"/>
          <field name="message_ids" widget="mail_thread"/>
        </div>
      </form>
    </field>
  </record>

  <record model="ir.ui.view" id="group_view_search">
    <field name="name">group.search</field>
    <field name="model">school.group</field>
    <field name="arch" type="xml">
      <search string="Group">
        <field name="name"/>
        <field name="student_ids" filter_domain="[('student_ids.name', 'ilike', self)]"/>
        <field name="supervisor_id"/>
      </search>
    </field>
  </record>

  <record id="group_action" model="ir.actions.act_window">
    <field name="name">Groups</field>
    <field name="res_model">school.group</field>
    <field name="view_type">form</field>
    <field name="view_mode">tree,form</field>
    <field name="view_ids" eval="[(5, 0, 0),
            (0, 0, {'view_mode': 'tree', 'view_id': ref('group_view_list')}),
            (0, 0, {'view_mode': 'form', 'view_id': ref('group_view_form')})]"/>
    <field name="search_view_id" ref="group_view_search"/>
  </record>

  <menuitem id="school_group_menu" action="group_action"
    sequence="20" parent="school.menu_school_root"/>

  <!-- options -->
  <record model="ir.ui.view" id="option_view_list">
    <field name="name">option.list</field>
    <field name="model">school.option</field>
    <field name="arch" type="xml">
      <tree string="Options" editable="bottom">
        <field name="name"/>
      </tree>
    </field>
  </record>

  <record id="option_action" model="ir.actions.act_window">
    <field name="name">Options</field>
    <field name="res_model">school.option</field>
    <field name="view_mode">tree</field>
  </record>

  <menuitem id="school_option_menu" action="option_action"
    sequence="30" parent="school.menu_school_root"/>

</odoo>
